datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

// Define your own datamodels here and run `yarn redwood prisma migrate dev`
// to create migrations for them and apply to your dev DB.
model User {
  // Basic info
  id                  Int       @id @default(autoincrement())
  email               String    @unique
  hashedPassword      String
  salt                String
  resetToken          String?
  resetTokenExpiresAt DateTime?

  // Relationship info
  games Game[]
}

enum GameType {
  SORTING
  MATCHING
}

model Game {
  // Basic info
  id        Int      @id @default(autoincrement())
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  type      GameType

  // Gameplay info
  wordsPerPhoneme Int
  phonemes        Int[]
  level           Int     @default(1)
  complete        Boolean @default(false)
  currentWordId   Int?

  // Relationship info
  allWords       Word[] @relation("allGames")
  currentWord    Word?  @relation("currentGames", fields: [currentWordId], references: [id])
  completedWords Word[] @relation("completedGames")
}

model Word {
  // Basic info
  id           Int      @id @default(autoincrement())
  word         String   @unique
  gradeLevel   Int
  numSyllables Int
  phonemes     Int[]
  graphemes    String[]
  syllables    String[]
  sentences    String[]

  // Relationship info
  allGames       Game[] @relation("allGames")
  currentGames   Game[] @relation("currentGames")
  completedGames Game[] @relation("completedGames")

  //   // Relationship info
  //   wordId Int
  //   word   Word @relation(fields: [wordId], references: [id])
  //   gameId Int
}

// model SortingGameWord {
//   // Basic info
//   id Int @id @default(autoincrement())
//   game   Game @relation(fields: [gameId], references: [id])

//   // Gameplay info
//   completed      Boolean @default(false)
//   current        Boolean @default(false)
//   testedGrapheme String
// }
